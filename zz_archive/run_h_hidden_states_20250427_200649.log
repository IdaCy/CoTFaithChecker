nohup: ignoring input
Working dir: /root/CoTFaithChecker
2025-04-27 20:06:51,711 - INFO - CUDA is available. Using GPU.
2025-04-27 20:06:51,711 - INFO - Loading model and tokenizer: deepseek-ai/DeepSeek-R1-Distill-Llama-8B onto cuda
/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:817: UserWarning: `return_dict_in_generate` is NOT set to `True`, but `output_hidden_states` is. When `return_dict_in_generate` is not `True`, `output_hidden_states` is ignored.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.11it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.11it/s]
2025-04-27 20:06:55,772 - INFO - Model and tokenizer loaded successfully.
2025-04-27 20:06:55,772 - INFO - Using chat template: <|begin_of_text|><|start_header_id|>user<|end_header_id|>{instruction}<|eot_id|><|start_header_id|>assistant<|end_header_id|>
2025-04-27 20:06:55,772 - INFO - --- Processing dataset for hint type: none ---
2025-04-27 20:06:55,780 - ERROR - Data file not found: data/mmlu/hints_none.json
2025-04-27 20:06:55,780 - INFO - Generating completions for none...
2025-04-27 20:06:55,782 - INFO - Using max_new_tokens: 2048
2025-04-27 20:06:55,782 - INFO - Processing batch 1/1 (Size: 1, QIDs: 0-0)
Traceback (most recent call last):
  File "/root/CoTFaithChecker/h_hidden_states/hint/run_hint.py", line 42, in <module>
    generate_dataset_completions(
  File "/root/CoTFaithChecker/h_hidden_states/hint/pipeline.py", line 126, in generate_dataset_completions
    results = generate_completion(
  File "/root/CoTFaithChecker/h_hidden_states/hint/model_handler.py", line 154, in generate_completion
    os.makedirs(output_location, exist_ok=True)
NameError: name 'os' is not defined
